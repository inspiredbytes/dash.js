!function(a){"use strict";window.namespace=function(a){for(var b,c=window,d=a.split(".");b=d.shift();)c[b]=c[b]||{},c=c[b]}}(window._),namespace("Dash.Browser"),function(){"use strict";Dash.Browser.Location={change:function(a){window.location.replace(a)},hash:function(){return window.location.hash},reload:function(){window.location.reload()},changeHref:function(a){window.location.href=a}},Dash.Browser.Navigator={userAgent:function(){return window.navigator.userAgent}},Dash.Browser.changeTitle=function(a){document.title=a},Dash.Browser.open=function(a,b){return window.open(a,"_blank",b)},Dash.Browser.close=function(){window.close()},Dash.Browser.setTimeout=function(a,b){return window.setTimeout(a,b)},Dash.Browser.setInterval=function(a,b){return window.setInterval(a,b)},Dash.Browser.isInIframe=function(){try{return window.self!==window.top}catch(a){return!0}},Dash.Browser.isIFramedBy=function(a){if(Dash.Browser.isInIframe())return window.top.location.origin===a},Dash.Browser.scrollToTop=function(){window.parent.postMessage("scrollTo:0",window.location.origin)},Dash.Browser.scrollToBottom=function(){console.log(document.body.scrollHeight),console.log($(document).height()),window.scrollTo(0,document.body.scrollHeight)}}(),namespace("Dash.OAuth"),function(a){"use strict";Dash.OAuth.Cookie={set:function(b,c,d){a.set(b,c,d)},get:function(b){return a.get(b)},expire:function(b){a.expire(b)},isEnabled:function(){return a.enabled}}}(Cookies),namespace("Dash.OAuth"),function(){"use strict";Dash.OAuth.LocalStorage={set:function(a,b,c){var d;c&&(d=60*c.expires),store.set(a,{value:b,expiresIn:d,createdAt:(new Date).getTime()})},get:function(a){var b=store.get(a),c=(new Date).getTime();if(b)return b.expiresIn&&c-b.createdAt>b.expiresIn?void this.expire(a):b.value},expire:function(a){store.remove(a)}}}(),namespace("Dash.OAuth"),namespace("Dash.OAuth.MemoryStorageData"),function(){"use strict";Dash.OAuth.MemoryStorage={set:function(a,b,c){Dash.OAuth.MemoryStorageData[a]=b},get:function(a){return Dash.OAuth.MemoryStorageData[a]},expire:function(a){Dash.OAuth.MemoryStorageData[a]=void 0}}}(),namespace("Dash.OAuth"),function(){"use strict";Dash.OAuth.Storage={names:{redirect:"DashOAuthRedirect",state:"DashOAuthState",token:"DashOAuthToken"},set:function(a,b,c){Dash.OAuth.MemoryStorage.set(a,b,c),Dash.OAuth.Cookie.set(a,b,c),Dash.OAuth.LocalStorage.set(a,b,c)},get:function(a){var b=Dash.OAuth.MemoryStorage.get(a);return void 0===b?Dash.OAuth.LocalStorage.get(a):(void 0===b&&(b=Dash.OAuth.Cookie.get(a)),b)},expire:function(a){Dash.OAuth.MemoryStorage.expire(a),Dash.OAuth.Cookie.expire(a),Dash.OAuth.LocalStorage.expire(a)}}}(),namespace("Dash.OAuth"),function(){"use strict";Dash.OAuth.Params=function(a){this.queryString=a,this.queryStringToObject=function(){var a={},b=this.queryString.slice(1).split("&");return b.forEach(function(b){var c=b.split("=");a[c[0]]=c[1]}),a},this.get=function(a){return this.queryStringToObject()[a]}}}(),namespace("Dash.OAuth"),function(a,b){"use strict";Dash.OAuth.UrlGenerator=function(c){this.baseUrl=c.baseUrl,this.clientId=c.clientId||"smi_platform",this.context=c.context,this.redirectUrl=c.redirectUrl,this.responseType=c.responseType,this.scopes=c.scopes,this.generate=function(){var c=a.create().hex,d=b.param({scope:this.scopes.join(" "),state:c,redirect_uri:this.redirectUrl,client_id:this.clientId,response_type:this.responseType,context:this.context});return{url:this.baseUrl+"?"+d,state:c}}}}(UUIDjs,jQuery),namespace("Dash.OAuth"),function(a){"use strict";Dash.OAuth.TokenAccessor={set:function(b,c,d){d=parseInt(d),a.set(this.key(b),c,{expires:d}),null!==d?a.set(this.expiresInKey(b),this._futureUnixTime(d),{expires:d}):this.expireExpiresIn(b)},get:function(b){return a.get(this.key(b))},_futureUnixTime:function(a){var b=1e3*parseInt(a);return new Date(Date.now()+b).valueOf()},getExpiresIn:function(b){var c=parseInt(a.get(this.expiresInKey(b)));return isNaN(c)?1/0:(c-Date.now())/1e3},expire:function(b){a.expire(this.key(b)),this.expireExpiresIn(b)},expireExpiresIn:function(b){a.expire(this.expiresInKey(b))},prefix:"smi-access-token:",expiresInPrefix:"smi-access-token-expiration:",key:function(a){return""+this.prefix+a},expiresInKey:function(a){return""+this.expiresInPrefix+a},expireAll:function(a){var b=this;$.each(a,function(a,c){b.expire(c)})}}}(Dash.OAuth.Storage),namespace("Dash.OAuth"),function(){"use strict";Dash.OAuth.TokenRefreshIframe=function(a){this.modalDataId="refresh-modal",this.$el=$('<iframe data-id="'+this.modalDataId+'" src="'+a+'"></iframe>'),this.render=function(){this.$el.hide(),$("body").append(this.$el)},this.remove=function(){this.$el.remove()}}}(),namespace("Dash.OAuth"),function(a){"use strict";Dash.OAuth.TokenValidator=function(b,c,d){this.expiration=d,this.state=b,this.token=c,this.isValidState=function(b){return a.get(a.names.state)===this.state},this.storeToken=function(){return a.set(a.names.token,this.token,{expires:this.expiration})},this.removeToken=function(){return a.expire(a.names.token)},this.storedToken=function(){return a.get(a.names.token)},this.hasStoredToken=function(){return void 0!==a.get(a.names.token)}}}(Dash.OAuth.Storage),namespace("Dash.OAuth"),function(a,b){"use strict";Dash.OAuth.AccessRequester=function(c){var d=300;this.urlGenerator=c,this.requestAccess=function(){var a=this.urlGenerator.generate();this.storeState(a.state),this.sendRequest(a.url)},this.storeState=function(b){a.set(a.names.state,b,{expires:d})},this.sendRequest=function(a){b.Location.change(a)}}}(Dash.OAuth.Storage,Dash.Browser),namespace("Dash.OAuth"),function(){"use strict";var a=function(a,b){return function(){return a.apply(b,arguments)}};Dash.OAuth.AutoRefresh=function(){function b(b,c,d){this.appId=b,this.urlGenerator=c,this.shouldShowCallback=d,this.refreshLocation=a(this.refreshLocation,this)}return b.prototype.modalDataId="refresh-modal",b.prototype.checkForTokenInterval=200,b.prototype.maxWaitForToken=6e3,b.prototype.register=function(){var a,b,c=this;return a=Dash.OAuth.TokenAccessor.getExpiresIn(this.appId),b=1e3*a,this.timeoutId=Dash.Browser.setTimeout(function(){return c.trigger()},b),this.timeoutId},b.prototype.trigger=function(){if(this.shouldShowModal())return this.cleanUp(),this.renderModal()},b.prototype.renderModal=function(){var a=this;Dash.OAuth.TokenAccessor.expire(this.appId),Dash.OAuth.Storage.set("isAutoRefresh","true");var b=this.urlGenerator.generate();return(new Dash.OAuth.AccessRequester).storeState(b.state),this.modal=this.createModal(b.url),this.modal.render(),this.refreshPageTimeoutId=Dash.Browser.setTimeout(function(){a.refreshLocation(b.url)},this.maxWaitForToken),this.intervalId=Dash.Browser.setInterval(function(){return a.closeModal()},this.checkForTokenInterval),this.intervalId},b.prototype.createModal=function(a){return new Dash.OAuth.TokenRefreshIframe(a)},b.prototype.refreshLocation=function(a){return Dash.OAuth.AutoRefresh.expireFlag(),Dash.Browser.Location.change(a)},b.prototype.closeModal=function(){if(void 0!==Dash.OAuth.TokenAccessor.get(this.appId))return this.cleanUp(),this.register()},b.prototype.cleanUp=function(){var a;return clearTimeout(this.timeoutId),clearTimeout(this.refreshPageTimeoutId),clearInterval(this.intervalId),void 0!==(a=this.modal)?a.remove():void 0},b.prototype.shouldShowModal=function(){return void 0===this.shouldShowCallback||this.shouldShowCallback()},b.expireFlag=function(){return Dash.OAuth.Storage.expire("isAutoRefresh")},b.isFlagSet=function(){return void 0!==Dash.OAuth.Storage.get("isAutoRefresh")},b}()}.call(this),namespace("Dash.OAuth"),function(){"use strict";Dash.OAuth.Response=function(a){this.normalizedLocationHash=function(a){var b;return b=a.split("#"),2===b.length?"?"+this.removeLeadingSlash(b[1]):3===b.length?"?"+this.removeLeadingSlash(b[2]):void 0},this.removeLeadingSlash=function(a){return/^\//.test(a)?a.substr(1,a.length):a},this.params=new Dash.OAuth.Params(this.normalizedLocationHash(a)),this.token=function(){return this.params.get("access_token")},this.context=function(){return this.params.get("context")},this.expiresIn=function(){return this.params.get("expires_in")},this.isValidState=function(){var a,b,c;return b=this.params.get("state"),a=this.params.get("expires_in"),c=new Dash.OAuth.TokenValidator(b,this.token(),a),c.isValidState()}}}(),namespace("Dash"),function(a,b){"use strict";Dash.Redirector=function(c){this.redirectUrl=c,this.register=function(){a.set("redirect-url",this.redirectUrl)},this.redirect=function(){var a=this.savedRedirectUrl();void 0!==a&&(b.changeHref(a),this.clearUrl())},this.savedRedirectUrl=function(){return a.get("redirect-url")},this.clearUrl=function(){a.expire("redirect-url")}}}(Dash.OAuth.TokenAccessor,Dash.Browser.Location);